<!DOCTYPE html>
<html lang="ru" xmlns:th="http://thymeleaf.org">

<head>
  <title>clear</title>
  <meta charset="utf-8">
  <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ viewport -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>...</title>
  <!-- Bootstrap CSS (jsDelivr CDN) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <!-- Bootstrap Bundle JS (jsDelivr CDN) -->
  <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
  <link rel="icon" href="https://cdn0.iconfinder.com/data/icons/business-1390/24/20_-_Company-2-256.png" type="image/x-icon">
  <link rel="shortcut icon" href="https://cdn0.iconfinder.com/data/icons/business-1390/24/20_-_Company-2-256.png" type="image/x-icon">
</head>
<script>
  function preview(event) {
    var input = event.target;
    var files = input.files;

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
    if (files.length > 1) {
      alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ñ–∞–π–ª.");
      input.value = ""; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
      return; // –ü—Ä–µ–∫—Ä–∞—â–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
    }
  }
</script>
<body>

<header th:insert ="~{fragments/header :: header}"></header>
<div class="container" style="margin-left: 200px; margin-right: 200px; height: 80vh">

  <form class="needs-validation" th:method="post" th:action="@{/loadReport}" enctype="multipart/form-data">
    <br>
    <h4 class="mb-3">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –æ—Ç—á—ë—Ç–∞ </h4>
    <h5 class="mb-3">(–∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –µ–≥–æ –≤ –æ–±–ª–∞—Å—Ç—å –Ω–∏–∂–µ üëá)</h5>
    <br>
      <div class="row g-5">
        <div class="col-md-6">
          <div id="dropContainer" style="border:1px; border-radius:10px; height:200px; background-image: url('/static/images/drag_drop.jpg'); background-size: cover; background-repeat: no-repeat; background-position: center;">
          </div>
          <br>
          <input type="file" id="fileInput"   name="fileInput" multiple accept=".csv, .xlsx" onchange="preview(event)"/>
          <script>
            dropContainer.ondragover = dropContainer.ondragenter = function(evt) {
              evt.preventDefault();
            };

            dropContainer.ondrop = function(evt) {
              evt.preventDefault();

              const files = evt.dataTransfer.files;
              const allowedExtensions = ['.csv', '.xlsx'];
              if (files.length>1){
                fileInput.value = null;
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–ª—å–∫–æ 1 —Ñ–∞–π–ª');
                return;
              }

              for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const fileName = file.name;
                const fileExtension = fileName.substring(fileName.lastIndexOf('.'));

                if (allowedExtensions.includes(fileExtension.toLowerCase())) {
                  // –ï—Å–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –¥–æ–ø—É—Å—Ç–∏–º–æ–µ, —Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ–º –Ω—É–∂–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
                  // –ù–∞–ø—Ä–∏–º–µ—Ä, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–∞–π–ª—ã –≤ fileInput
                  fileInput.files = files;
                } else {
                  // –ï—Å–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –Ω–µ –¥–æ–ø—É—Å—Ç–∏–º–æ–µ, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
                  fileInput.value = null;
                  alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º .csv –∏–ª–∏ .xlsx');
                  return;
                }
              }
            };
          </script>
        </div>
      </div>
      </br>
      <div class="row g-5">
        <div class="col-md-6">
          <select class="form-select" required name="system">
            <option value="–Ø–Ω–¥–µ–∫—Å" selected>–Ø–Ω–¥–µ–∫—Å.–î–∏—Ä–µ–∫—Ç</option>
            <option value="Google">Google Ads</option>
          </select>
        </div>
      </div>
    <br>
    <div class="row g-5">
      <div class="col-md-6">
        <input type="text" class="form-control" id="name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞" name="name" required>
      </div>
    </div>
    <div th:if="${error} == '–æ—à–∏–±–∫–∞'">
      <br>
      <h5 class="mb-3" style="color: firebrick">–ó–∞–≥—Ä—É–∂–µ–Ω –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–∞–π–ª –æ—Ç—á—ë—Ç–∞! –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —á–∏—Å—Ç–∫—É</h5>
    </div>
    <br>
      <div class="row g-5">
        <div class="col-md-6">
          <button class="w-100 btn btn-lg btn-light" style = "background-color: #ffc24b; color: black; border-color: white;" type="submit">–ù–∞—á–∞—Ç—å —á–∏—Å—Ç–∫—É</button>
        </div>
      </div>
  </form>
  </br>
</div>
<div th:replace="fragments/footer :: footer"></div>
</body>
</html>